{% extends 'base.html' %}

{% block body %}
<div class="container-fluid mt-2 mb-5 p-5">
    
  <h2>IGV browser for {{ sample_id }}</h2>
  <div>
    <h3 style="display: inline;"> Using reference: </h3>
    <h3 style="display: inline; text-transform: lowercase;"><b>{{ reference }}</b></h3>
  </div>
  <br>
  Note: Samples with high depth of sequencing may take a while to load.
  <br></br>

  <div id="igv-div" class="p-2" style="border:1px solid lightgray; background-color: white;"></div>
</div>
{% endblock %}

{% block script %}
<!-- loading igv with passed urls -->
<script type="text/javascript">

  var igvDiv = document.getElementById("igv-div");
  var options =
    {
      showNavigation: true,
      showRuler: true,
      showKaryo: true,
      reference: {
        "id": "{{ reference }}",
        "name": "Human ({{ reference }})",
        "fastaURL": "{{ fasta }}",
        "indexURL": "{{ fasta_idx }}",
        "cytobandURL": "{{ cytoband }}",
        "tracks": [
          {
            "name": "{{ sample_id }}",
            "url": "{{ file_url }}",
            "indexURL": "{{ idx_url }}",
            "displayMode": "EXPANDED"
          },
          {
            "name": "Refseq Genes",
            "format": "refgene",
            "url": "{{ refseq }}",
            "order": 1000000,
            "indexed": false
          }
        ],
      }
    };
  igv.createBrowser(igvDiv, options);
</script>
{% endblock %}