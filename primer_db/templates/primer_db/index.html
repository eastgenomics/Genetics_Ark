{% extends 'base.html' %}
{% load render_table from django_tables2 %}
{% load static %}


{% block body_block %}

<body style="padding-top: 80px; padding-left: 80px">

<!-- success message when primer is deleted from edit_primer and returns to index -->
{% if messages %} 
    {% for message in messages %}
        <div class="alert {{ message.tags }}" role="alert">
            <strong>{{ message }}</strong> 
        </div>
    {% endfor %} 
{% endif %} 



<span style="float:right;">
    <a href="/primer_db/help" target="_blank">
    <img style="width: 50px; height: 100px; padding-top: 10px" alt="Image" src="{% static 'images/gif2.gif' %}"/>
    </a>
</span>
    

<h1>Primer Database</h1></br>

<div class = "alert alert-warning">
    <h3>
        This version is still under development. Please check that the data, coverages are correct.<br>
        If you have any suggestions/improvements, email rainfoj@addenbrookes.nhs.uk
    </h3>
</div><br>

<div class="row center-block">

<a href="/primer_db/submit"><button type="button" class = "bt btn-primary">Submit single primer</button></a>

<a href="/primer_db/submit_pair"><button type="button" class = "bt btn-primary">Submit primer pair</button></a></br></br>

<!-- form for primer name filter -->

<form method="post" action="" style="padding-top:10px;">
    {% csrf_token %}
    <input type="text" name="name_filter" placeholder="Search primer name">
    <button id="search_submit" type="submit">Submit</button>&nbsp;&nbsp;&nbsp;
    
    <input type="text" name="gene_filter" placeholder="Search exact gene name">
    <button id="search_submit" type="submit">Submit</button>
</form></br>


<!-- form for variant position filter -->
<form method="post" action="" style="padding-top:5px;">
    {% csrf_token %}
  Chromosome no: <select name="chrom_no"> 
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
        <option value="13">13</option>
        <option value="14">14</option>
        <option value="15">15</option>
        <option value="16">16</option>
        <option value="17">17</option>
        <option value="18">18</option>
        <option value="19">19</option>
        <option value="20">20</option>
        <option value="21">21</option>
        <option value="22">22</option>
        <option value="23">23</option>
        <option value="X">X</option>
        <option value="Y">Y</option>
  </select>&nbsp;&nbsp;
    <input type="text" name="var_pos" placeholder="Search variant position:">
    <button id="search_submit" type="submit">Submit</button>
</form></br>

{% if var_pos and chrom_no %}
  Showing results for position {{ var_pos }} on chromosome {{ chrom_no }} </br></br>
{% endif %}


<form action="" method="post">
    
    {% csrf_token %}

    Change primer status: 

    <select name="new_status">
        <option value="Archived">Archived</option>
        <option value="On Order">On Order</option>
        <option value="In Bank">In Bank</option>
    </select>
    
    <button type="submit" name="change_status"/>Submit</button></br></br>
    
    Select primer pair to recalculate coverage: 

    <input type="submit" name="recalc" value="Recalculate"></br></br>
    
    {% if recalc %}
        <ul>
            {% for ele in recalc %}
                <li>{{ ele }}</li>
            {% endfor %}
        </ul>
    {% endif %}

    <ul>
        {% if nb_primers %}
            <li>Number of primers: {{ nb_primers }}</li>
            <li>Number of primers not snp checked: {{ not_check }}</li>
            <li>Number of primers that passed snp check: {{ passed_check }}</li>
            <li>Number of primers that failed snp check: <button type="submit" name="failed_snp_check" style="background: none!important;
                    border: none;
                    padding: 0!important;
                    /*optional*/
                    font-family: arial, sans-serif;
                    /*input has OS specific font-family*/
                    color: #069;
                    text-decoration: underline;
                    cursor: pointer;">{{ failed_check }}</button></li>
            <li>Number of primers manually snp checked: {{ manually_checked }}</li>
            <li>Number of primers not able to be snp checked: {{ not_in_gnomAD }}</li>
        {% endif %}
    </ul>

    {% render_table table "django_tables2/bootstrap-responsive.html" %}

</form>


</html>
</body>
</br>




<a href="/primer_db/"><button type="button" class = "bt btn-primary">View all</button></a></br></br>

Total primers in bank: {{ total_bank }}</br>
Total primers on order: {{ total_order }}</br>
Total primers in archive: {{ total_archived }}

{% endblock %}

